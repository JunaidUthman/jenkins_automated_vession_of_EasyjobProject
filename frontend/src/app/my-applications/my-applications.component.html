<!-- my-applications.component.html -->
<div class="home-container">
  <div class="home-content">

    <!-- Page Header -->
    <div class="page-header">
      <h1>My Applications</h1>
      <p>Manage and track your job applications</p>
    </div>

    <!-- Navigation Tabs -->
    <div class="tabs-container">
      <button class="tab-btn" [class.active]="activeTab === 'jobs'" (click)="setActiveTab('jobs')">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z" />
        </svg>
        Applied Jobs
      </button>

      <button class="tab-btn" [class.active]="activeTab === 'internships'" (click)="setActiveTab('internships')">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path
            d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z" />
        </svg>
        Applied Internships
      </button>
    </div>

    <!-- Jobs List -->
    <div class="jobs-list">

      <!-- Loading State -->
      <div class="empty-state" *ngIf="isLoading">
        <div class="spinner-container">
          <div class="spinner"></div>
          <h3>Loading Applications...</h3>
        </div>
      </div>

      <!-- Application Card -->
      <div class="job-card" *ngFor="let job of displayedJobs">

        <!-- Left: Company Logo (20%) -->
        <div class="job-card-logo">
          <div class="logo-wrapper">
            <img *ngIf="job.logoUrl" [src]="job.logoUrl" alt="Company Logo">
            <svg *ngIf="!job.logoUrl" xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="#cbd5e1"
              viewBox="0 0 24 24">
              <path
                d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8V9h8v10zm-2-8h-4v2h4v-2zm0 4h-4v2h4v-2z" />
            </svg>
          </div>
        </div>

        <!-- Right: Job Information (80%) -->
        <div class="job-card-content">

          <!-- Header: Title/Company (No Bookmark) -->
          <div class="content-header">
            <div class="title-section">
              <h3 class="job-title">{{ job.title }}</h3>
              <p class="job-company">{{ job.company }}</p>
            </div>
          </div>

          <!-- Location & Time -->
          <div class="card-metadata">
            <div class="info-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                stroke-width="2" viewBox="0 0 24 24">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                <circle cx="12" cy="10" r="3" />
              </svg>
              {{ job.location }}
            </div>
            <div class="info-item">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor"
                stroke-width="2" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 6v6l4 2" />
              </svg>
              <!-- Display application date if available, or just job creation date -->
              {{ job.createdAt ? (job.createdAt | date:'mediumDate') : 'Applied' }}
            </div>
          </div>

          <!-- Badges -->
          <div class="card-badges">
            <span class="badge badge-contract">{{ job.contract_type }}</span>
            <span class="badge badge-education">{{ job.educationLevel }}</span>
          </div>

          <!-- Description -->
          <p class="card-description">{{ job.description }}</p>

          <!-- Action Buttons -->
          <div class="card-actions">
            <!-- Cancel Application Button -->
            <button class="btn-cancel" (click)="cancelApplication(job.id)" [disabled]="cancellingJobId === job.id">
              <span *ngIf="cancellingJobId !== job.id">Cancel Application</span>
              <span *ngIf="cancellingJobId === job.id" class="btn-loading">
                <span class="btn-spinner"></span>
                Cancelling...
              </span>
            </button>
            <button class="btn-view-details">View Details</button>
          </div>
        </div>

      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="displayedJobs.length === 0 && !isLoading">
        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="#cbd5e1" viewBox="0 0 24 24">
          <path
            d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z" />
        </svg>
        <h3>No applications found</h3>
        <p>You haven't applied to any {{ activeTab }} yet.</p>
      </div>
    </div>

  </div>
</div>